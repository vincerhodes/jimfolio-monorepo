services:
  jimfolio:
    build:
      context: ./jimfolio-site
      dockerfile: Dockerfile
      args:
        HTTP_PROXY: ""
        HTTPS_PROXY: ""
        http_proxy: ""
        https_proxy: ""
    restart: always
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production

  sweet-reach:
    build:
      context: ./sweet-reach-demo
      dockerfile: Dockerfile
      args:
        HTTP_PROXY: ""
        HTTPS_PROXY: ""
        http_proxy: ""
        https_proxy: ""
    restart: always
    ports:
      - "3001:3000"
    environment:
      - NODE_ENV=production
      # Ensure DATABASE_URL is set if using a real DB, or mount volume for SQLite
      - DATABASE_URL=file:/app/prisma/dev.db
    volumes:
      - ./sweet-reach-data:/app/prisma

  nginx:
    image: nginx:alpine
    restart: always
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/conf.d/default.conf
    depends_on:
      - jimfolio
      - sweet-reach
